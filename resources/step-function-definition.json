{
  "Comment": "Marketing and Sales ETL Pipeline Orchestrator.",
  "StartAt": "Pre-process",
  "States": {
    "Pre-process": {
      "Type": "Pass",
      "Next": "Start Parallel Glue Jobs"
    },
    "Start Parallel Glue Jobs": {
      "Type": "Parallel",
      "Branches": [
        {
          "StartAt": "Wait For Sales Data",
          "States": {
            "Wait For Sales Data": {
              "Type": "Task",
              "Resource": "arn:aws:states:us-east-1:***REMOVED***:activity:etl-datasets-2-1-2022-SalesPipeline_QuickSightSample.csv",
              "Next": "Prep for Process Sales Data"
            },
            "Prep for Process Sales Data": {
              "Type": "Pass",
              "Result": "{\"GlueJobName\" : \"ProcessSalesData\"}",
              "Next": "Process Sales Data"
            },
            "Process Sales Data": {
              "Type": "Task",
              "Resource": "arn:aws:states:us-east-1:***REMOVED***:activity:GlueRunnerActivity",
              "End": true
            }
          }
        },
        {
          "StartAt": "Wait For Marketing Data",
          "States": {
            "Wait For Marketing Data": {
              "Type": "Task",
              "Resource": "arn:aws:states:us-east-1:***REMOVED***:activity:etl-datasets-2-1-2022-MarketingData_QuickSightSample.csv",
              "Next": "Prep for Process Marketing Data"
            },
            "Prep for Process Marketing Data": {
              "Type": "Pass",
              "Result": "{\"GlueJobName\" : \"ProcessMarketingData\"}",
              "Next": "Process Marketing Data"
            },
            "Process Marketing Data": {
              "Type": "Task",
              "Resource": "arn:aws:states:us-east-1:***REMOVED***:activity:GlueRunnerActivity",
              "End": true
            }
          }
        }
      ],
      "Next": "Prep For Joining Marketing And Sales Data",
      "Catch": [
        {
          "ErrorEquals": [
            "GlueJobFailedError"
          ],
          "Next": "ETL Job Failed Fallback"
        }
      ]
    },
    "Prep For Joining Marketing And Sales Data": {
      "Type": "Pass",
      "Result": "{\"GlueJobName\" : \"JoinMarketingAndSalesData\"}",
      "Next": "Join Marketing And Sales Data"
    },
    "Join Marketing And Sales Data": {
      "Type": "Task",
      "Resource": "arn:aws:states:us-east-1:***REMOVED***:activity:GlueRunnerActivity",
      "Catch": [
        {
          "ErrorEquals": [
            "GlueJobFailedError"
          ],
          "Next": "ETL Job Failed Fallback"
        }
      ],
      "End": true
    },
    "ETL Job Failed Fallback": {
      "Type": "Pass",
      "Result": "This is a fallback from an ETL job failure.",
      "End": true
    }
  }
}